<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WWE Random Draft Simulator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- ADD THIS CSS --- */
        body {
            /* Replace this with your image link */
            background-image: url('https://assets-prd.ignimgs.com/2022/04/27/smackdown-vs-raw-2006-button-1651039943451.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
        }

        /* This adds a dark overlay so text is easier to read */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(17, 24, 39, 0.85); /* dark-gray-900 at 85% opacity */
            z-index: -1; /* Puts it behind the content */
        }
        /* --- END OF ADDED CSS --- */

        /* Custom styles for draft status */
        #draft-status.raw { color: #f87171; /* red-400 */ }
        #draft-status.smackdown { color: #60a5fa; /* blue-400 */ }
        #draft-status.nxt { color: #facc15; /* yellow-400 */ }
        
        /* Styles for the modal text */
        #modal-brand-text.raw { color: #ef4444; /* red-500 */ }
        #modal-brand-text.smackdown { color: #3b82f6; /* blue-500 */ }
        #modal-brand-text.nxt { color: #eab308; /* yellow-500 */ }
        
        /* Next pick brand color */
        #next-pick-brand.raw { color: #f87171; /* red-400 */ }
        #next-pick-brand.smackdown { color: #60a5fa; /* blue-400 */ }
        #next-pick-brand.nxt { color: #facc15; /* yellow-400 */ }


        /* Pop-in animation for the final name */
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        #modal-wrestler-name.final-pick {
            animation: popIn 0.3s ease-out forwards;
        }
        
        /* Style for the drumroll text */
        #modal-wrestler-name.drumroll {
            opacity: 0.7;
            transform: scale(0.95);
            transition: none;
        }
    </style>
</head>
<body class="text-white font-sans antialiased"> <!-- REMOVED 'bg-gray-900' from this line -->

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold mb-2">WWE Random Draft Simulator</h1>
            <p class="text-lg text-gray-400">Click wrestlers from the database to add them to the draft pool.</p>
        </header>

        <!-- New Layout: Database on Left, Draft Area on Right -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

            <!-- Column 1: Database & Draft Controls -->
            <div class="space-y-8">
                
                <!-- Wrestler Database Section -->
                <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                    <h2 class="text-2xl font-semibold mb-4">1. Wrestler Database (Click to Add)</h2>
                    <div id="wrestler-database-list" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 h-[40rem] overflow-y-auto pr-2">
                        <!-- Wrestler Database items will be populated by JS -->
                    </div>
                </div>

                <!-- Draft Controls -->
                <div class="bg-gray-800 p-6 rounded-lg shadow-lg sticky top-8">
                    <h2 class="text-2xl font-semibold mb-4">
                        2. Draft Controls (Next Pick: <span id="next-pick-brand" class="font-bold raw">RAW</span>)
                    </h2>
                    <div class="grid grid-cols-2 gap-4">
                        <button id="draft-next-btn" class="col-span-2 bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow transition duration-200">
                            Draft Next Wrestler
                        </button>
                        <button id="draft-all-btn" class="col-span-2 bg-yellow-600 hover:bg-yellow-700 text-gray-900 font-bold py-3 px-6 rounded-lg shadow transition duration-200">
                            Draft All Remaining
                        </button>
                        
                        <!-- Save/Load Layout -->
                        <input type="text" id="draft-name-input" placeholder="Enter Draft Name" class="col-span-2 bg-gray-700 text-white border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button id="save-draft-btn" class="col-span-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow transition duration-200">
                            Save Draft
                        </button>
                        <button id="load-draft-btn" class="col-span-1 bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg shadow transition duration-200">
                            Load Draft
                        </button>

                        <!-- Toggle NXT Button -->
                        <button id="toggle-nxt-btn" class="col-span-2 bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-bold py-3 px-6 rounded-lg shadow transition duration-200">
                            Add NXT to Draft
                        </button>
                        
                        <button id="reset-draft-btn" class="col-span-2 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg shadow transition duration-200">
                            Reset Draft
                        </button>
                    </div>
                    <div class="text-center mt-4 h-6">
                        <span id="draft-status" class="text-lg font-medium transition-all duration-300"></span>
                    </div>
                </div>
            </div>

            <!-- Column 2: Main Draft Area -->
            <div class="space-y-8">
                <!-- Available Wrestlers -->
                <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                    <h2 class="text-2xl font-semibold mb-4 text-center">Available for Draft (<span id="available-count">0</span>)</h2>
                    <ul id="available-wrestlers-list" class="space-y-3 h-64 overflow-y-auto pr-2">
                        <!-- Wrestlers will be populated by JS -->
                    </ul>
                </div>

                <!-- Rosters -->
                <!-- Roster Grid will be dynamically changed -->
                <div id="roster-grid" class="grid grid-cols-1 sm:grid-cols-2 gap-8">
                    <!-- Raw Roster -->
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg border-t-4 border-red-500">
                        <h2 class="text-3xl font-bold mb-4 text-center text-red-400">RAW (<span id="raw-count">0</span>)</h2>
                        <ul id="raw-roster-list" class="space-y-2 h-80 overflow-y-auto pr-2">
                            <!-- Raw picks will be populated by JS -->
                        </ul>
                    </div>

                    <!-- Smackdown Roster -->
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg border-t-4 border-blue-500">
                        <h2 class="text-3xl font-bold mb-4 text-center text-blue-400">SMACKDOWN (<span id="smackdown-count">0</span>)</h2>
                        <ul id="smackdown-roster-list" class="space-y-2 h-80 overflow-y-auto pr-2">
                            <!-- Smackdown picks will be populated by JS -->
                        </ul>
                    </div>

                    <!-- NXT Roster (Initially Hidden) -->
                    <div id="nxt-roster-container" class="bg-gray-800 p-6 rounded-lg shadow-lg border-t-4 border-yellow-500 hidden sm:col-span-2">
                        <h2 class="text-3xl font-bold mb-4 text-center text-yellow-400">NXT (<span id="nxt-count">0</span>)</h2>
                        <ul id="nxt-roster-list" class="space-y-2 h-80 overflow-y-auto pr-2">
                            <!-- NXT picks will be populated by JS -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Draft Pick Modal (Simplified) -->
    <div id="draft-overlay" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center hidden z-50 p-4">
        <div id="draft-modal" class="bg-gray-800 rounded-lg shadow-2xl p-8 sm:p-12 text-center overflow-hidden w-full max-w-2xl">
            <h2 id="modal-brand-text" class="text-3xl sm:text-4xl font-bold mb-8 transition-all duration-300">...</h2>
            
            <div class="h-24 flex items-center justify-center overflow-hidden"> <!-- Container to prevent layout shift -->
                <h1 id="modal-wrestler-name" class="text-4xl sm:text-6xl font-extrabold transition-all duration-200" style="text-shadow: 2px 2px 8px rgba(0,0,0,0.5);">...</h1>
            </div>
        </div>
    </div>

    <!-- Load Draft Modal -->
    <div id="load-draft-overlay" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center hidden z-50 p-4">
        <div class="bg-gray-800 rounded-lg shadow-2xl p-8 w-full max-w-lg">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Load a Saved Draft</h2>
                <button id="close-load-modal-btn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded-lg text-2xl">&times;</button>
            </div>
            <div id="load-draft-list-container" class="h-64 overflow-y-auto pr-2">
                <!-- Saved draft list items will be populated by JS -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- "DATABASE" ---
            const Database = {
                masterWrestlerDatabase: [
                    'Abdullah the Butcher', 'Abyss', 'Adam Cole', 'Adam Page', 'Afa',
                    'AJ Styles', 'Akira Taue', 'Al Snow', 'Alberto Del Rio', 'Andre the Giant',
                    'Animal (Road Warrior)', 'Antonio Inoki', 'Arn Anderson', 'Bad News Brown', 'Bam Bam Bigelow',
                    'Baron Von Raschke', 'Barry Windham', 'Batista', 'Big Boss Man', 'Big E',
                    'Big Show', 'Billy Graham', 'Billy Gunn', 'Blackjack Mulligan', 'Blue Demon',
                    'Bob Armstrong', 'Bob Backlund', 'Bobo Brazil', 'Bobby Eaton', 'Bobby Fish',
                    'Bobby Lashley', 'Bobby Roode', 'Booker T', 'Braun Strowman', 'Bret Hart',
                    'Brian Pillman', 'Brock Lesnar', 'Brodie Lee', 'Bron Breakker', 'Bronco Nagurski',
                    'Bruiser Brody', 'Bruno Sammartino', 'Brutus Beefcake', 'Bubba Ray Dudley', 'Buddy Rogers',
                    'Bull Curry', 'Captain Lou Albano', 'Cesaro', 'Chad Gable', 'Chris Adams',
                    'Chris Benoit', 'Chris Candido', 'Chris Daniels', 'Chris Hero', 'Chris Jericho','Chris Masters',
                    'Chris Sabin', 'Christian Cage', 'CM Punk', 'Cody Rhodes', 'Crusher',
                    'D-Von Dudley', 'Damian Priest', 'Daniel Bryan', 'Danny Hodge', 'Davey Boy Smith',
                    'David Von Erich', 'Dean Malenko', 'Diamond Dallas Page', 'Dick Beyer (The Destroyer)', 'Dick Murdoch',
                    'Dick the Bruiser', 'DLo Brown', 'Dolph Ziggler', 'Dominic DeNucci', 'Dominik Mysterio',
                    'Don Muraco', 'Dory Funk Jr.', 'Dr. Death Steve Williams', 'Dr. Wagner Jr.', 'Drew McIntyre',
                    'Dusty Rhodes', 'Dynamite Kid', 'Earthquake', 'Eddie Gilbert', 'Eddie Guerrero',
                    'Eddie Kingston', 'Edge', 'El Canek', 'El Hijo del Santo', 'El Santo',
                    'Eric Young', 'Ernie Ladd', 'Finn Bálor', 'Fit Finlay', 'Fritz Von Erich',
                    'Gene Kiniski', 'Genichiro Tenryu', 'George Hackenschmidt', 'George Steele', 'Giant Baba',
                    'Goldberg', 'Goldust', 'Gorilla Monsoon', 'Gorgeous George', 'Great Muta',
                    'Great Sasuke', 'Greg Valentine', 'Gunther', 'Haku', 'Harley Race',
                    'Hawk (Road Warrior)', 'Hayabusa', 'Hiroshi Tanahashi', 'Honky Tonk Man', 'Hulk Hogan',
                    'Ilja Dragunov', 'Ivan Koloff', 'Ivan Putski', 'Jack Brisco', 'Jake Roberts',
                    'Jay Briscoe', 'Jay Lethal', 'Jay White', 'JBL', 'Jeff Cobb',
                    'Jeff Hardy', 'Jeff Jarrett', 'Jerry Brisco', 'Jerry Lawler', 'Jerry Lynn',
                    'Jey Uso', 'Jim Duggan', 'Jim Londos', 'Jim Neidhart', 'Jimmy Snuka',
                    'Jimmy Uso', 'John Cena', 'John Kronus', 'John Morrison', 'Johnny Gargano',
                    'Johnny Valentine', 'Jon Moxley', 'Jun Akiyama', 'Junkyard Dog', 'Jushin Thunder Liger',
                    'Kane', 'Karl Anderson', 'Karl Gotch', 'Karrion Kross', 'Kazuchika Okada',
                    'Ken Shamrock', 'Kendo Nagasaki', 'Kenny Omega', 'Kenta', 'Kenta Kobashi',
                    'Kerry Von Erich', 'Kevin Nash', 'Kevin Owens', 'Kevin Sullivan', 'Kevin Von Erich',
                    'Killer Khan', 'Killer Kowalski', 'King Curtis Iaukea', 'King Kong Bundy', 'Kofi Kingston',
                    'Koko B. Ware', 'Konnan', 'Kurt Angle', 'KUSHIDA', 'LA Knight',
                    'Lance Storm', 'Larry Zbyszko', 'Lex Luger', 'Lou Thesz', 'Low Ki',
                    'Luke Gallows', 'Magnum T.A.', 'Mark Briscoe', 'Mark Henry', 'Marty Jannetty',
                    'Masahiro Chono', 'Masato Tanaka', 'Matt Hardy', 'Matt Jackson', 'Michael Hayes',
                    'Mick Foley', 'Mike Awesome', 'Mike Rotunda', 'Mil Mascaras', 'Minoru Suzuki',
                    'Mitsuharu Misawa', 'The Miz', 'MJF', 'Mr. Fuji', 'Mr. Perfect',
                    'Mr. Wrestling II', 'Muhammad Ali', 'Naomichi Marufuji', 'New Jack', 'Nick Aldis',
                    'Nick Bockwinkel', 'Nick Gage', 'Nick Jackson', 'Nikolai Volkoff', 'Ole Anderson',
                    "One Man Gang", 'Owen Hart', 'PAC', 'Pat OConnor', 'Pat Patterson',
                    'Paul Orndorff', 'Pentagon Jr.', 'Perry Saturn', 'Pete Dunne', 'Psicosis',
                    'Psycho Sid', 'R-Truth', 'Randy Orton', 'Randy Savage', 'Raven',
                    'Rey Fenix', 'Rey Mysterio', 'Ric Flair', 'Ricochet', 'Rick Rude',
                    'Rick Steiner', 'Ricky Steamboat', 'Rikidozan', 'Rikishi', 'Riki Choshu',
                    'Road Dogg', 'Rob Van Dam', 'The Rock', 'Rocky Johnson', 'Roddy Piper',
                    'Roman Reigns', 'Ron Fuller', 'Ron Simmons', 'Sabu', 'Samoa Joe',
                    'Sami Zayn', 'Sammy Guevara', 'Sandman', 'Scott Hall', 'Scott Steiner',
                    'Sgt. Slaughter', 'Seth Rollins', 'Shane Douglas', 'Shane McMahon', 'Shawn Michaels',
                    'Sheamus', 'Shelton Benjamin', 'Shingo Takagi', 'Shinsuke Nakamura', 'Sika',
                    'Stan Hansen', 'Stan Stasiak', 'Steve Corino', 'Sting', 'Stone Cold Steve Austin',
                    'Superstar Billy Graham', 'Stu Hart', 'Tajiri', 'Tatanka', 'Tatsumi Fujinami',
                    'Tazz', 'Ted DiBiase', 'Terry Funk', 'Terry Gordy', 'Tetsuya Naito',
                    'The Barbarian', 'The Great Khali', 'The Sheik', 'The Undertaker', 'Tiger Mask',
                    'Tito Santana', 'Tommaso Ciampa', 'Tommy Dreamer', 'Tommy Rich', 'Tony Atlas',
                    'Toshiaki Kawada', 'Triple H', 'Tully Blanchard', 'Typhoon', 'Ultimo Dragon',
                    'Umaga', 'Ultimate Warrior', 'Vader', 'Vampiro', 'Verne Gagne',
                    'Vince McMahon', 'Wahoo McDaniel', 'Wardlow', 'William Regal', 'Will Ospreay',
                    'X-Pac', 'Yokozuna', 'Yoshihiro Takayama', 
                    'Yuji Nagata', 'Zack Sabre Jr.'
                ],
                WWE_ALL_DRAFTS_KEY: 'wweAllDraftSaves'
            };
            
            // --- STATE ---
            const State = {
                availableWrestlers: [],
                rawRoster: [],
                smackdownRoster: [],
                nxtRoster: [],
                allSavedDrafts: {},
                activeShows: ['raw', 'smackdown'],
                nextPickBrand: 'raw',
                isDrafting: false,
                drumrollInterval: null
            };

            // --- DOM ELEMENTS ---
            const DOM = {
                resetBtn: document.getElementById('reset-draft-btn'),
                draftNextBtn: document.getElementById('draft-next-btn'),
                draftAllBtn: document.getElementById('draft-all-btn'),
                saveDraftBtn: document.getElementById('save-draft-btn'),
                loadDraftBtn: document.getElementById('load-draft-btn'),
                draftNameInput: document.getElementById('draft-name-input'),
                toggleNxtBtn: document.getElementById('toggle-nxt-btn'),
                databaseListEl: document.getElementById('wrestler-database-list'),
                availableList: document.getElementById('available-wrestlers-list'),
                rawList: document.getElementById('raw-roster-list'),
                smackdownList: document.getElementById('smackdown-roster-list'),
                nxtList: document.getElementById('nxt-roster-list'),
                rosterGrid: document.getElementById('roster-grid'),
                nxtRosterContainer: document.getElementById('nxt-roster-container'),
                availableCount: document.getElementById('available-count'),
                rawCount: document.getElementById('raw-count'),
                smackdownCount: document.getElementById('smackdown-count'),
                nxtCount: document.getElementById('nxt-count'),
                draftStatus: document.getElementById('draft-status'),
                nextPickBrandEl: document.getElementById('next-pick-brand'),
                draftOverlay: document.getElementById('draft-overlay'),
                modalBrandText: document.getElementById('modal-brand-text'),
                modalWrestlerName: document.getElementById('modal-wrestler-name'),
                loadDraftOverlay: document.getElementById('load-draft-overlay'),
                loadDraftListContainer: document.getElementById('load-draft-list-container'),
                closeLoadModalBtn: document.getElementById('close-load-modal-btn')
            };

            // --- UI MODULE ---
            const UI = {
                render: () => {
                    UI.renderDatabaseList();
                    UI.renderAvailableList();
                    UI.renderRosterLists();
                    UI.updateCountsAndButtons();
                    UI.updateLayoutForShows();
                },

                renderDatabaseList: () => {
                    DOM.databaseListEl.innerHTML = '';
                    const allAddedNames = [ ...State.availableWrestlers, ...State.rawRoster, ...State.smackdownRoster, ...State.nxtRoster ];
                    const draftedNames = [ ...State.rawRoster, ...State.smackdownRoster, ...State.nxtRoster ];

                    Database.masterWrestlerDatabase.sort();

                    Database.masterWrestlerDatabase.forEach(wrestlerName => {
                        const button = document.createElement('button');
                        button.className = 'bg-gray-700 rounded-lg shadow-md p-2 transition duration-200 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500';
                        
                        const isDrafted = draftedNames.includes(wrestlerName);
                        const isAdded = allAddedNames.includes(wrestlerName);

                        let overlayText = '';
                        if (isDrafted) overlayText = 'DRAFTED';
                        else if (isAdded) overlayText = 'IN POOL';
                        
                        button.innerHTML = `
                            <span class="block text-sm font-medium truncate">${wrestlerName}</span>
                            ${isAdded ? `<span class="block text-xs font-bold text-gray-400 mt-1">${overlayText}</span>` : ''}
                        `;
                        
                        button.disabled = isAdded || State.isDrafting;
                        if (isAdded) button.classList.add('opacity-50', 'cursor-not-allowed');

                        if (!isAdded) {
                            button.addEventListener('click', () => {
                                State.availableWrestlers.push(wrestlerName);
                                UI.render();
                            });
                        }
                        DOM.databaseListEl.appendChild(button);
                    });
                },

                renderAvailableList: () => {
                    DOM.availableList.innerHTML = '';
                    State.availableWrestlers.sort();
                    
                    if (State.availableWrestlers.length === 0) {
                        DOM.availableList.innerHTML = '<li class="text-gray-500 text-center italic">No wrestlers in draft pool.</li>';
                    } else {
                        // MODIFIED: Added index and remove button
                        State.availableWrestlers.forEach((wrestlerName, index) => {
                            const li = document.createElement('li');
                            li.className = 'bg-gray-700 p-3 rounded-lg shadow font-medium flex justify-between items-center';
                            
                            const nameSpan = document.createElement('span');
                            nameSpan.textContent = wrestlerName;
                            
                            const removeBtn = document.createElement('button');
                            removeBtn.className = 'text-red-400 hover:text-red-300 font-bold text-lg px-2';
                            removeBtn.innerHTML = '&times;'; // 'X' icon
                            removeBtn.disabled = State.isDrafting; // Disable if drafting
                            
                            removeBtn.addEventListener('click', () => {
                                if (State.isDrafting) return;
                                State.availableWrestlers.splice(index, 1); // Remove by index
                                UI.render(); // Re-render everything
                            });
                            
                            li.appendChild(nameSpan);
                            li.appendChild(removeBtn);
                            DOM.availableList.appendChild(li);
                        });
                    }
                },

                renderRosterLists: () => {
                    DOM.rawList.innerHTML = '';
                    DOM.smackdownList.innerHTML = '';
                    DOM.nxtList.innerHTML = '';
                    
                    State.rawRoster.sort();
                    State.smackdownRoster.sort();
                    State.nxtRoster.sort();

                    const createRosterItem = (listEl, roster, emptyText) => {
                        if (roster.length === 0) {
                            listEl.innerHTML = `<li class="text-gray-500 italic">${emptyText}</li>`;
                        } else {
                            roster.forEach(wrestlerName => {
                                const li = document.createElement('li');
                                let brandClass = '';
                                if (listEl === DOM.rawList) brandClass = 'bg-red-900 bg-opacity-30';
                                else if (listEl === DOM.smackdownList) brandClass = 'bg-blue-900 bg-opacity-30';
                                else if (listEl === DOM.nxtList) brandClass = 'bg-yellow-900 bg-opacity-30';
                                
                                li.className = `${brandClass} text-white p-3 rounded-lg shadow font-medium`;
                                li.textContent = wrestlerName; 
                                listEl.appendChild(li);
                            });
                        }
                    };

                    createRosterItem(DOM.rawList, State.rawRoster, 'No wrestlers drafted.');
                    createRosterItem(DOM.smackdownList, State.smackdownRoster, 'No wrestlers drafted.');
                    createRosterItem(DOM.nxtList, State.nxtRoster, 'No wrestlers drafted.');
                },
                
                updateCountsAndButtons: () => {
                    DOM.availableCount.textContent = State.availableWrestlers.length;
                    DOM.rawCount.textContent = State.rawRoster.length;
                    DOM.smackdownCount.textContent = State.smackdownRoster.length;
                    DOM.nxtCount.textContent = State.nxtRoster.length;
                    
                    DOM.nextPickBrandEl.textContent = State.nextPickBrand.toUpperCase();
                    DOM.nextPickBrandEl.className = `font-bold ${State.nextPickBrand}`;
                    
                    const noWrestlers = State.availableWrestlers.length === 0;
                    DOM.draftNextBtn.disabled = noWrestlers || State.isDrafting;
                    DOM.draftAllBtn.disabled = noWrestlers || State.isDrafting;
                    DOM.resetBtn.disabled = State.isDrafting;
                    DOM.saveDraftBtn.disabled = State.isDrafting;
                    DOM.loadDraftBtn.disabled = State.isDrafting;
                    DOM.toggleNxtBtn.disabled = State.isDrafting;
                },

                updateLayoutForShows: () => {
                    if (State.activeShows.includes('nxt')) {
                        DOM.rosterGrid.classList.remove('sm:grid-cols-2');
                        DOM.rosterGrid.classList.add('sm:grid-cols-3');
                        DOM.nxtRosterContainer.classList.remove('hidden', 'sm:col-span-2');
                        DOM.nxtRosterContainer.classList.add('sm:col-span-1');
                        DOM.toggleNxtBtn.textContent = 'Remove NXT from Draft';
                    } else {
                        DOM.rosterGrid.classList.remove('sm:grid-cols-3');
                        DOM.rosterGrid.classList.add('sm:grid-cols-2');
                        DOM.nxtRosterContainer.classList.add('hidden', 'sm:col-span-2');
                        DOM.nxtRosterContainer.classList.remove('sm:col-span-1');
                        DOM.toggleNxtBtn.textContent = 'Add NXT to Draft';
                    }
                },
                
                showDraftStatus: (message, type = 'draft') => {
                    DOM.draftStatus.textContent = message;
                    if (type === 'raw') DOM.draftStatus.className = 'text-lg font-medium raw';
                    else if (type === 'smackdown') DOM.draftStatus.className = 'text-lg font-medium smackdown';
                    else if (type === 'nxt') DOM.draftStatus.className = 'text-lg font-medium nxt';
                    else if (type === 'reset') DOM.draftStatus.className = 'text-lg font-medium text-yellow-400';
                    else if (type === 'save') DOM.draftStatus.className = 'text-lg font-medium text-blue-400';
                    else if (type === 'load') DOM.draftStatus.className = 'text-lg font-medium text-purple-400';
                    else if (type === 'error') DOM.draftStatus.className = 'text-lg font-medium text-red-400';
                    else DOM.draftStatus.className = 'text-lg font-medium text-green-400';
                    
                    setTimeout(() => {
                        DOM.draftStatus.textContent = '';
                        DOM.draftStatus.className = '';
                    }, 3000);
                }
            };

            // --- DRAFT MODULE ---
            const Draft = {
                draftNextWrestler: () => {
                    if (State.isDrafting || State.availableWrestlers.length === 0) return;

                    State.isDrafting = true;
                    
                    const currentPickBrand = State.nextPickBrand;
                    const index = Math.floor(Math.random() * State.availableWrestlers.length);
                    const draftedWrestler = State.availableWrestlers.splice(index, 1)[0];

                    if (currentPickBrand === 'raw') State.rawRoster.push(draftedWrestler);
                    else if (currentPickBrand === 'smackdown') State.smackdownRoster.push(draftedWrestler);
                    else if (currentPickBrand === 'nxt') State.nxtRoster.push(draftedWrestler);
                    
                    const currentIndex = State.activeShows.indexOf(currentPickBrand);
                    const nextIndex = (currentIndex + 1) % State.activeShows.length;
                    State.nextPickBrand = State.activeShows[nextIndex];
                    
                    UI.render();

                    // --- Start Animation ---
                    DOM.modalBrandText.textContent = `${currentPickBrand.toUpperCase()} IS ON THE CLOCK`;
                    DOM.modalBrandText.className = `text-3xl sm:text-4xl font-bold mb-8 transition-all duration-300 ${currentPickBrand}`;
                    DOM.modalWrestlerName.textContent = '...';
                    DOM.modalWrestlerName.classList.remove('final-pick', 'drumroll');
                    DOM.draftOverlay.classList.remove('hidden');

                    setTimeout(() => {
                        DOM.modalBrandText.textContent = 'THE PICK IS IN...';
                        const drumrollPool = [...State.availableWrestlers, draftedWrestler]; 
                        
                        if (drumrollPool.length > 0) {
                            DOM.modalWrestlerName.classList.add('drumroll');
                            State.drumrollInterval = setInterval(() => {
                                const randomName = drumrollPool[Math.floor(Math.random() * drumrollPool.length)];
                                DOM.modalWrestlerName.textContent = randomName;
                            }, 75);
                        }
                    }, 1500);

                    setTimeout(() => {
                        if (State.drumrollInterval) {
                            clearInterval(State.drumrollInterval);
                            State.drumrollInterval = null;
                        }
                        DOM.modalWrestlerName.classList.remove('drumroll');
                        DOM.modalWrestlerName.textContent = draftedWrestler;
                        DOM.modalWrestlerName.classList.add('final-pick');
                    }, 3000);

                    setTimeout(() => {
                        DOM.draftOverlay.classList.add('hidden');
                        State.isDrafting = false;
                        if (State.drumrollInterval) {
                            clearInterval(State.drumrollInterval);
                            State.drumrollInterval = null;
                        }
                        UI.render();
                    }, 5500);
                },

                draftAllWrestlers: () => {
                    if (State.availableWrestlers.length === 0) return;

                    while (State.availableWrestlers.length > 0) {
                        const index = Math.floor(Math.random() * State.availableWrestlers.length);
                        const wrestler = State.availableWrestlers.splice(index, 1)[0];
                        
                        const currentPickBrand = State.nextPickBrand;
                        if (currentPickBrand === 'raw') State.rawRoster.push(wrestler);
                        else if (currentPickBrand === 'smackdown') State.smackdownRoster.push(wrestler);
                        else if (currentPickBrand === 'nxt') State.nxtRoster.push(wrestler);
                        
                        const currentIndex = State.activeShows.indexOf(currentPickBrand);
                        const nextIndex = (currentIndex + 1) % State.activeShows.length;
                        State.nextPickBrand = State.activeShows[nextIndex];
                    }
                    
                    UI.showDraftStatus('All remaining wrestlers have been drafted!', 'success');
                    UI.render();
                },

                toggleNxt: () => {
                    if (State.activeShows.includes('nxt')) {
                        State.activeShows = ['raw', 'smackdown'];
                        State.availableWrestlers = [...State.availableWrestlers, ...State.nxtRoster];
                        State.nxtRoster = [];
                        State.nextPickBrand = 'raw';
                    } else {
                        State.activeShows = ['raw', 'smackdown', 'nxt'];
                    }
                    UI.render();
                }
            };

            // --- STORAGE MODULE ---
            const Storage = {
                loadAllSavedDrafts: () => {
                    const savedDataJSON = localStorage.getItem(Database.WWE_ALL_DRAFTS_KEY);
                    if (savedDataJSON) {
                        try {
                            State.allSavedDrafts = JSON.parse(savedDataJSON);
                        } catch (e) {
                            console.error("Error parsing all saved drafts", e);
                            State.allSavedDrafts = {};
                        }
                    } else {
                        State.allSavedDrafts = {};
                    }
                },

                saveDraft: () => {
                    const draftName = DOM.draftNameInput.value.trim();
                    if (!draftName) {
                        UI.showDraftStatus('Please enter a name for your draft.', 'error');
                        return;
                    }
                    
                    const draftData = {
                        available: State.availableWrestlers,
                        raw: State.rawRoster,
                        smackdown: State.smackdownRoster,
                        nxt: State.nxtRoster,
                        nextPick: State.nextPickBrand,
                        shows: State.activeShows
                    };
                    
                    State.allSavedDrafts[draftName] = draftData;
                    
                    try {
                        localStorage.setItem(Database.WWE_ALL_DRAFTS_KEY, JSON.stringify(State.allSavedDrafts));
                        UI.showDraftStatus(`Draft '${draftName}' saved!`, 'save');
                        DOM.draftNameInput.value = '';
                    } catch (e) {
                        console.error("Error saving to local storage", e);
                        UI.showDraftStatus('Error: Could not save draft.', 'error');
                    }
                },
                
                openLoadModal: () => {
                    DOM.loadDraftListContainer.innerHTML = '';
                    const draftNames = Object.keys(State.allSavedDrafts);
                    
                    if (draftNames.length === 0) {
                        DOM.loadDraftListContainer.innerHTML = '<p class="text-gray-400 italic text-center">No saved drafts found.</p>';
                    } else {
                        draftNames.sort().forEach(draftName => {
                            const div = document.createElement('div');
                            div.className = 'flex justify-between items-center p-3 bg-gray-700 rounded-lg mb-2';
                            
                            const nameSpan = document.createElement('span');
                            nameSpan.className = 'font-medium';
                            nameSpan.textContent = draftName;
                            
                            const buttonDiv = document.createElement('div');
                            buttonDiv.className = 'space-x-2';
                            
                            const loadBtn = document.createElement('button');
                            loadBtn.className = 'text-green-400 hover:text-green-300 font-bold';
                            loadBtn.textContent = 'Load';
                            loadBtn.onclick = () => Storage.loadDraftByName(draftName);
                            
                            const deleteBtn = document.createElement('button');
                            deleteBtn.className = 'text-red-400 hover:text-red-300 font-bold';
                            deleteBtn.textContent = 'Delete';
                            deleteBtn.onclick = () => Storage.deleteDraft(draftName);
                            
                            buttonDiv.appendChild(loadBtn);
                            buttonDiv.appendChild(deleteBtn);
                            div.appendChild(nameSpan);
                            div.appendChild(buttonDiv);
                            DOM.loadDraftListContainer.appendChild(div);
                        });
                    }
                    
                    DOM.loadDraftOverlay.classList.remove('hidden');
                },
                
                loadDraftByName: (draftName) => {
                    const savedData = State.allSavedDrafts[draftName];
                    
                    if (savedData) {
                        State.availableWrestlers = savedData.available || [];
                        State.rawRoster = savedData.raw || [];
                        State.smackdownRoster = savedData.smackdown || [];
                        State.nxtRoster = savedData.nxt || [];
                        State.nextPickBrand = savedData.nextPick || 'raw';
                        State.activeShows = savedData.shows || ['raw', 'smackdown'];
                        
                        UI.render();
                        DOM.loadDraftOverlay.classList.add('hidden');
                        UI.showDraftStatus(`Draft '${draftName}' loaded!`, 'load');
                    } else {
                        UI.showDraftStatus(`Error: Could not find draft '${draftName}'.`, 'error');
                    }
                },
                
                deleteDraft: (draftName) => {
                    delete State.allSavedDrafts[draftName];
                    try {
                        localStorage.setItem(Database.WWE_ALL_DRAFTS_KEY, JSON.stringify(State.allSavedDrafts));
                        Storage.openLoadModal(); // Re-open/refresh the modal list
                    } catch (e) {
                        console.error("Error saving after delete", e);
                        UI.showDraftStatus('Error: Could not delete draft.', 'error');
                    }
                },

                resetDraft: (silent = false) => {
                    State.availableWrestlers = [];
                    State.rawRoster = [];
                    State.smackdownRoster = [];
                    State.nxtRoster = [];
                    State.activeShows = ['raw', 'smackdown'];
                    State.nextPickBrand = 'raw';
                    State.isDrafting = false;
                    
                    DOM.draftOverlay.classList.add('hidden'); 
                    
                    if (State.drumrollInterval) {
                        clearInterval(State.drumrollInterval);
                        State.drumrollInterval = null;
                    }
                    
                    if (!silent) {
                        UI.showDraftStatus('Draft reset. Current pool cleared.', 'reset');
                    }
                    UI.render();
                }
            };

    
            // --- EVENT LISTENERS ---
            function initEventListeners() {
                DOM.draftNextBtn.addEventListener('click', Draft.draftNextWrestler);
                DOM.draftAllBtn.addEventListener('click', Draft.draftAllWrestlers);
                DOM.resetBtn.addEventListener('click', () => Storage.resetDraft(false));
                DOM.saveDraftBtn.addEventListener('click', Storage.saveDraft);
                DOM.loadDraftBtn.addEventListener('click', Storage.openLoadModal);
                DOM.closeLoadModalBtn.addEventListener('click', () => DOM.loadDraftOverlay.classList.add('hidden'));
                DOM.toggleNxtBtn.addEventListener('click', Draft.toggleNxt);
            }

            // --- INITIAL LOAD ---
            Storage.loadAllSavedDrafts(); // Load all drafts into memory
            UI.render(); // Initial render
            initEventListeners(); // Set up all the buttons
        });
    </script>
</body>
</html>

